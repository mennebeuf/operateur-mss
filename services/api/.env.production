# ===========================================
# MSSanté API - Configuration PRODUCTION
# ===========================================
# ⚠️  ATTENTION: Ne jamais commiter ce fichier avec les vraies valeurs!
# ⚠️  Utiliser des secrets managers ou variables d'environnement système
# ===========================================

# ===========================================
# ENVIRONNEMENT
# ===========================================
NODE_ENV=production
PORT=3000
LOG_LEVEL=info

# ===========================================
# BASE DE DONNÉES POSTGRESQL
# ===========================================
DB_HOST=postgres
DB_PORT=5432
DB_NAME=mssante
DB_USER=mssante
DB_PASSWORD=${POSTGRES_PASSWORD}
DB_SSL=true
DB_POOL_MIN=5
DB_POOL_MAX=20

# ===========================================
# REDIS (Cache & Sessions)
# ===========================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=${REDIS_PASSWORD}
REDIS_DB=0
REDIS_TLS=true

# ===========================================
# JWT & SESSIONS
# ===========================================
JWT_SECRET=${JWT_SECRET}
JWT_EXPIRES_IN=3600
JWT_ISSUER=mssante-api
JWT_AUDIENCE=mssante-client
REFRESH_TOKEN_EXPIRES_IN=604800

# ===========================================
# PRO SANTÉ CONNECT (Environnement PRODUCTION)
# ===========================================
PSC_CLIENT_ID=${PSC_CLIENT_ID}
PSC_CLIENT_SECRET=${PSC_CLIENT_SECRET}
PSC_REDIRECT_URI=https://${DOMAIN}/auth/psc/callback
PSC_AUTH_URL=https://auth.esw.esante.gouv.fr/auth/realms/esante-wallet/protocol/openid-connect/auth
PSC_TOKEN_URL=https://auth.esw.esante.gouv.fr/auth/realms/esante-wallet/protocol/openid-connect/token
PSC_USERINFO_URL=https://auth.esw.esante.gouv.fr/auth/realms/esante-wallet/protocol/openid-connect/userinfo
PSC_LOGOUT_URL=https://auth.esw.esante.gouv.fr/auth/realms/esante-wallet/protocol/openid-connect/logout
PSC_SCOPE=openid email profile scope_all

# ===========================================
# ANS - OPÉRATEUR
# ===========================================
OPERATOR_ID=${OPERATOR_ID}
ANNUAIRE_API_URL=https://annuaire.sante.fr/api/v1
ANNUAIRE_API_KEY=${ANNUAIRE_API_KEY}

# ===========================================
# DOMAINE & URLs
# ===========================================
DOMAIN=${DOMAIN}
API_URL=https://api.${DOMAIN}
FRONTEND_URL=https://${DOMAIN}

# ===========================================
# SMTP CONFIGURATION (Postfix)
# ===========================================
SMTP_HOST=postfix
SMTP_PORT=587
SMTP_SECURE=true
SMTP_USER=
SMTP_PASSWORD=

# ===========================================
# IMAP CONFIGURATION (Dovecot)
# ===========================================
IMAP_HOST=dovecot
IMAP_PORT=143
IMAP_SECURE=true

# ===========================================
# EMAIL SETTINGS
# ===========================================
DEFAULT_FROM_EMAIL=noreply@${DOMAIN}
ADMIN_EMAIL=admin@${DOMAIN}

# ===========================================
# CERTIFICATS SSL/TLS (IGC Santé)
# ===========================================
SSL_CERT_PATH=/etc/ssl/certs/igc-sante/server.pem
SSL_KEY_PATH=/etc/ssl/private/igc-sante/server.key
SSL_CA_PATH=/etc/ssl/certs/igc-sante/ca-bundle.pem

# ===========================================
# RATE LIMITING (Strict en production)
# ===========================================
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# ===========================================
# LOGGING (Production)
# ===========================================
LOG_DIR=/var/log/mssante-api
LOG_MAX_SIZE=10485760
LOG_MAX_FILES=30
ENABLE_DEBUG_LOGS=false

# ===========================================
# CORS (Strict en production)
# ===========================================
CORS_ORIGIN=https://${DOMAIN}
CORS_CREDENTIALS=true

# ===========================================
# MONITORING
# ===========================================
METRICS_ENABLED=true
METRICS_PORT=9090

# ===========================================
# SÉCURITÉ (Production)
# ===========================================
ENABLE_STACK_TRACE=false
ENABLE_REQUEST_LOGGING=true
TRUST_PROXY=true

# ===========================================
# HEALTH CHECK
# ===========================================
HEALTH_CHECK_INTERVAL=30000
HEALTH_CHECK_TIMEOUT=5000