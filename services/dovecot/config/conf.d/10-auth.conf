# =============================================================================
# Configuration authentification Dovecot
# =============================================================================

# Désactiver l'authentification anonyme
disable_plaintext_auth = yes

# Mécanismes d'authentification
auth_mechanisms = plain login

# Authentification via SQL
passdb {
    driver = sql
    args = /etc/dovecot/dovecot-sql.conf.ext
}

userdb {
    driver = sql
    args = /etc/dovecot/dovecot-sql.conf.ext
}

# Service d'authentification pour Postfix (SASL)
service auth {
    # Socket Unix pour les services locaux
    unix_listener auth-userdb {
        mode = 0660
        user = vmail
        group = vmail
    }

    # Socket TCP pour Postfix (conteneur séparé)
    inet_listener {
        port = 12345
    }
}

# Format des usernames
auth_username_format = %Lu